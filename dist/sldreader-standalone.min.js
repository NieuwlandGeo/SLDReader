var SLDReader=function(e,t,n,r,i,o,s,l,a,c,u,f,h,p,m,g,d,y,w,b,k,x,_){"use strict";const S="IMAGE_LOADING",N="IMAGE_LOADED",C="IMAGE_ERROR",P="PLACEMENT_FIRSTPOINT",M="PLACEMENT_LASTPOINT",I="metre",L="foot",v="pixel",E="none",z="comparison",O=["PropertyIsEqualTo","PropertyIsNotEqualTo","PropertyIsLessThan","PropertyIsLessThanOrEqualTo","PropertyIsGreaterThan","PropertyIsGreaterThanOrEqualTo"],D=O.concat(["PropertyIsLike","PropertyIsNull","PropertyIsBetween"]);function A(e){return D.includes(e.localName)}function G(e){return["or","and"].includes(e.localName.toLowerCase())}function T(e,t){if(O.includes(e.localName))return R(e,t);if("PropertyIsBetween"===e.localName)return function(e,t){const n={type:z,operator:e.localName.toLowerCase(),matchcase:"false"!==e.getAttribute("matchCase")},r={};t(e,r,"expressions",{concatenateLiterals:!1}),r.expressions&&r.expressions.children&&(n.expression=r.expressions.children[0],n.lowerboundary=r.expressions.children[1],n.upperboundary=r.expressions.children[2]);return n}(e,t);if("PropertyIsNull"===e.localName)return function(e,t){const n={};return t(e,n,"expressions",{concatenateLiterals:!1}),{type:z,operator:e.localName.toLowerCase(),expression:n.expressions}}(e,t);if("PropertyIsLike"===e.localName)return function(e,t){const n=R(e,t);return{...n,wildcard:e.getAttribute("wildCard"),singlechar:e.getAttribute("singleChar"),escapechar:e.getAttribute("escapeChar")}}(e,t);throw new Error(`Unknown comparison element ${e.localName}`)}function R(e,t){const n={type:z,operator:e.localName.toLowerCase(),matchcase:"false"!==e.getAttribute("matchCase")},r={};return t(e,r,"expressions",{concatenateLiterals:!1}),r.expressions&&r.expressions.children&&(n.expression1=r.expressions.children[0],n.expression2=r.expressions.children[1]),n}function F(e,t){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)r&&A(r)&&n.push(T(r,t)),r&&G(r)&&n.push(F(r,t)),r&&"not"===r.localName.toLowerCase()&&n.push($(r,t));return{type:e.localName.toLowerCase(),predicates:n}}function $(e,t){let n=null;const r=e.firstElementChild;return r&&A(r)&&(n=T(r,t)),r&&G(r)&&(n=F(r,t)),r&&"not"===r.localName.toLowerCase()&&(n=$(r,t)),{type:e.localName.toLowerCase(),predicate:n}}const q=new Set(["strokeWidth","strokeOpacity","strokeDashoffset","fillOpacity","fontSize"]),W=new Set(["strokeOpacity","fillOpacity"]),H=/^data:image\/svg\+xml;base64,(.*)(\?.*)/,U=/param\(([^)]*)\)/g;function V(e,t,n,r){const i=n.toLowerCase();t[i]=t[i]||[];const o={};ie(e,o,r),t[i].push(o)}function J(e,t,n){const r=n.toLowerCase();t[r]=t[r]||[];const i={type:"symbolizer"},o=e.getAttribute("uom");if(o)switch(o){case"http://www.opengeospatial.org/se/units/metre":i.uom=I;break;case"http://www.opengeospatial.org/se/units/foot":i.uom=L;break;case"http://www.opengeospatial.org/se/units/pixel":i.uom=v;break;default:console.warn("Unsupported uom attribute found, one of http://www.opengeospatial.org/se/units/(metre|feet|pixel) expected."),i.uom=v}else i.uom=v;ie(e,i,{uom:i.uom}),t[r].push(i)}function j(e,t,n,r){const i=n.toLowerCase();t[i]={},ie(e,t[i],r)}function K(e,t,n,r){const i=n.toLowerCase();r&&r.trimText?t[i]=e.textContent.trim():t[i]=e.textContent}function X(e,t,n){const r=n.toLowerCase(),i=parseFloat(e.textContent.trim());t[r]=i}function Y(e,t,n){const r={...{skipEmptyNodes:!0,forceLowerCase:!0,typeHint:"string",concatenateLiterals:!0,uom:E},...arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}},i=[];for(let t=0;t<e.childNodes.length;t+=1){const n=e.childNodes[t],o={};if("http://www.opengis.net/ogc"===n.namespaceURI&&"PropertyName"===n.localName)o.type="propertyname",o.typeHint=r.typeHint,o.value=n.textContent.trim(),"number"!==o.typeHint||r.uom!==I&&r.uom!==L||(o.uom=r.uom);else if("http://www.opengis.net/ogc"===n.namespaceURI&&"Function"===n.localName){const e=n.getAttribute("name"),t=n.getAttribute("fallbackValue")||null;o.type="function",o.name=e,o.fallbackValue=t;const i={};Y(n,i,"params",{...r,concatenateLiterals:!1}),Array.isArray(i.params.children)?o.params=i.params.children:o.params=[i.params]}else if("Add"===n.localName||"Sub"===n.localName||"Mul"===n.localName||"Div"===n.localName){o.type="function",o.name=`__fe:${n.localName}__`,o.typeHint="number";const e={};Y(n,e,"params",{...r,concatenateLiterals:!1}),Array.isArray(e.params.children)?o.params=e.params.children:o.params=[e.params]}else"#cdata-section"===n.nodeName?(o.type="literal",o.typeHint=r.typeHint,o.value=n.textContent):n.nodeType!==Node.COMMENT_NODE&&(o.type="literal",o.typeHint=r.typeHint,o.value=n.textContent.trim());"literal"===o.type&&r.skipEmptyNodes?o.value.trim()&&i.push(o):i.push(o)}const o=r.forceLowerCase?n.toLowerCase():n;let s=function(e,t,n,r){if(!Array.isArray(e))return e;const i=e.map((e=>"literal"===e.type&&e.uom!==I&&e.uom!==L?e.value:e)).filter((e=>""!==e));if(n&&i.every((e=>"object"!=typeof e||null===e)))return i.join("");return 1===i.length?i[0]:{type:"expression",typeHint:t,uom:r,children:i}}(i,r.typeHint,r.concatenateLiterals,r.uom);if("string"==typeof s&&"number"===r.typeHint){const e=s.indexOf("px")>-1?v:r.uom;s=e===I||e===L?{type:"literal",typeHint:"number",value:parseFloat(s),uom:e}:parseFloat(s)}t[o]=s}function B(e,t,n){Y(e,t,n,{...arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},typeHint:"number"})}function Z(e,t,n){Y(e,t,n,{...arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},typeHint:"number",uom:E})}function Q(e,t){const n=e.getElementsByTagNameNS("http://www.opengis.net/sld",t);return!!n.length&&Boolean(n.item(0).textContent)}function ee(e,t,n,r,i){const o={...i};t[r]=t[r]||{};const s=e.getAttribute("name").toLowerCase().replace(/-(.)/g,((e,t)=>t.toUpperCase()));let l="string",a=o.uom;"styling"===r&&(q.has(s)&&(l="number"),W.has(s)&&(a=E)),Y(e,t[r],s,{...i,skipEmptyNodes:!0,forceLowerCase:!1,typeHint:l,uom:a})}const te={Filter:(e,t)=>{t.filter=function(e,t){let n={};for(let r=e.firstElementChild;r;r=r.nextElementSibling)A(r)&&(n=T(r,t)),G(r)&&(n=F(r,t)),"not"===r.localName.toLowerCase()&&(n=$(r,t)),"featureid"===r.localName.toLowerCase()&&(n.type="featureid",n.fids=n.fids||[],n.fids.push(r.getAttribute("fid")));return n}(e,Y)},ElseFilter:(e,t)=>{t.elsefilter=!0}},ne={PolygonSymbolizer:J,LineSymbolizer:J,PointSymbolizer:J,TextSymbolizer:J,Fill:j,Stroke:j,GraphicStroke:j,GraphicFill:(e,t,n,r)=>j(e,t,n,{...r,uom:v}),Graphic:function(e,t,n,r){const i=n.toLowerCase();t[i]={},function(e,t,n){let r=!1;for(let i=e.firstElementChild;i;i=i.nextElementSibling)(!r||"Mark"!==i.localName&&"ExternalGraphic"!==i.localName)&&re[i.localName]&&(re[i.localName](i,t,i.localName,n),"Mark"!==i.localName&&"ExternalGraphic"!==i.localName||(r=!0))}(e,t[i],r)},ExternalGraphic:function(e,t,n,r){const i=n.toLowerCase();t[i]={},ie(e,t[i],r);const o=t[i];if(o.onlineresource){if(o.onlineresource=o.onlineresource.trim(),/^base64:/.test(o.onlineresource)&&o.format){const e=`data:${o.format||""};base64,`,t=o.onlineresource.replace(/^base64:/,"");o.onlineresource=`${e}${t}`}if(H.test(o.onlineresource))try{const[,e,t]=o.onlineresource.match(H),n=window.atob(e),r=new URLSearchParams(t),i=n.replace(U,((e,t)=>r.get(t)||"")),s=window.btoa(i);o.onlineresource=`data:${o.format||""};base64,${s}`}catch(e){console.error("Error converting parametric SVG: ",e)}}else if(o.inlinecontent)if(o.encoding?.indexOf("base64")>-1)o.onlineresource=`data:${o.format||""};base64,${o.inlinecontent}`,delete o.inlinecontent;else if(o.encoding?.indexOf("xml")>-1){const e=window.encodeURIComponent(o.inlinecontent);o.onlineresource=`data:image/svg+xml;utf8,${e}`,delete o.inlinecontent}},Format:K,Gap:B,InitialGap:B,Mark:j,Label:(e,t,n,r)=>Y(e,t,n,{...r,skipEmptyNodes:!1}),Halo:j,Font:j,Radius:B,LabelPlacement:j,PointPlacement:j,LinePlacement:j,PerpendicularOffset:B,AnchorPoint:j,AnchorPointX:Z,AnchorPointY:Z,Opacity:Z,Rotation:Z,Displacement:j,DisplacementX:B,DisplacementY:B,Size:B,WellKnownName:K,MarkIndex:X,VendorOption:(e,t,n,r)=>ee(e,t,0,"vendoroptions",r),OnlineResource:(e,t)=>{t.onlineresource=e.getAttribute("xlink:href")},InlineContent:(e,t)=>{t.encoding=e.getAttribute("encoding"),t.encoding?.indexOf("base64")>-1?t.inlinecontent=e.textContent?.trim():t.encoding?.indexOf("xml")>-1&&(t.inlinecontent=e.innerHTML?.trim())},CssParameter:(e,t,n,r)=>ee(e,t,0,"styling",r),SvgParameter:(e,t,n,r)=>ee(e,t,0,"styling",r)},re={NamedLayer:(e,t)=>{V(e,t,"layers")},UserLayer:(e,t)=>{V(e,t,"layers")},UserStyle:(e,t)=>{t.styles=t.styles||[];const n={default:Q(e,"IsDefault"),featuretypestyles:[]};ie(e,n),t.styles.push(n)},FeatureTypeStyle:(e,t)=>{t.featuretypestyle=t.featuretypestyle||[];const n={rules:[]};ie(e,n),t.featuretypestyles.push(n)},Rule:(e,t)=>{const n={};ie(e,n),t.rules.push(n)},Name:K,Title:K,Abstract:K,Description:ie,MaxScaleDenominator:X,MinScaleDenominator:X,...te,...ne};function ie(e,t,n){for(let r=e.firstElementChild;r;r=r.nextElementSibling)re[r.localName]&&re[r.localName](r,t,r.localName,n)}const oe=new Map;function se(e,t){if("function"!=typeof t)throw new Error("Function implementation is not a function");oe[e]=t}function le(e){return oe[e]||null}function ae(e){if(null===e)return"";const t=typeof e;switch(t){case"string":return e;case"number":case"bigint":case"boolean":return e.toString();case"undefined":return"";default:return t}}function ce(e){switch(e){case"Point":case"MultiPoint":return 0;case"LineString":case"LinearRing":case"Circle":case"MultiLineString":return 1;case"Polygon":case"MultiPolygon":return 2;default:return-1}}function ue(e){if(e&&(e.uom===I||e.uom===L))return!0;switch((e||{}).type){case"expression":case"propertyname":case"function":return!0;default:return!1}}function fe(e,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=null;const s=typeof e;if("string"===s||"number"===s||"undefined"===s||"boolean"===s||null===e)o=e;else if("literal"===e.type)o=e.value;else if("propertyname"===e.type){const t=e.value;o=n?"function"==typeof n.getGeometryName&&t===n.getGeometryName()?n.getGeometry():r.getProperty(n,t):i}else if("expression"===e.type)if(1===e.children.length)o=fe(e.children[0],n,r,i);else{const t=[];for(let i=0;i<e.children.length;i+=1)t.push(fe(e.children[i],n,r,null));o=t.join("")}else if("function"===e.type&&"dimension"===e.name&&n instanceof t)o=ce(n.getType());else if("function"===e.type){const t=le(e.name);if(t)try{o=t(...e.params.map((e=>fe(e,n,r))))}catch{o=e.fallbackValue}else o=e.fallbackValue}if(0===o)return o;if((null==o||""===o||Number.isNaN(o))&&(o=i),e&&("number"===e.typeHint&&(o=Number(o),Number.isNaN(o)&&(o=i)),e.uom===L&&(o*=.3048),e.uom===I||e.uom===L)){o/=r?r.resolution:1}return o}function he(e){return null==e}function pe(e){return""===e?NaN:Number(e)}function me(e,t,n){const r=pe(e),i=pe(t);if(!Number.isNaN(r)&&!Number.isNaN(i))return function(e,t){return e<t?-1:e===t?0:1}(r,i);const o=e.toString(),s=t.toString();return n?o.localeCompare(s):o.toLowerCase().localeCompare(s.toLowerCase())}function ge(e,t,n){const r=fe(e.expression1,t,n);if(he(r))return!1;const i=fe(e.expression2,t,n);return!he(i)&&me(r,i)<0}function de(e,t,n){const r=fe(e.expression1,t,n);if(he(r))return!1;const i=fe(e.expression2,t,n);return!he(i)&&me(r,i)>0}function ye(e,t,n){const r=fe(e.expression1,t,n);if(he(r))return!1;const i=fe(e.expression2,t,n);return!he(i)&&(e.matchcase&&"boolean"!=typeof r&&"boolean"!=typeof i?r==i:0===me(r,i,!1))}function we(e,t,n){switch(e.operator){case"propertyislessthan":return ge(e,t,n);case"propertyisequalto":return ye(e,t,n);case"propertyislessthanorequalto":return ye(e,t,n)||ge(e,t,n);case"propertyisnotequalto":return function(e,t,n){return!he(fe(e.expression1,t,n))&&(!he(fe(e.expression2,t,n))&&!ye(e,t,n))}(e,t,n);case"propertyisgreaterthan":return de(e,t,n);case"propertyisgreaterthanorequalto":return ye(e,t,n)||de(e,t,n);case"propertyisbetween":return function(e,t,n){const r=fe(e.expression,t,n);if(he(r))return!1;const i=fe(e.lowerboundary,t,n);if(he(i))return!1;const o=fe(e.upperboundary,t,n);return!he(o)&&me(i,r)<=0&&me(o,r)>=0}(e,t,n);case"propertyisnull":return function(e,t,n){return he(fe(e.expression,t,n))}(e,t,n);case"propertyislike":return function(e,t,n){const r=fe(e.expression1,t,n);if(he(r))return!1;const i=fe(e.expression2,t,n);if(he(i))return!1;const{wildcard:o,singlechar:s,escapechar:l,matchcase:a}=e;let c=i.replace(new RegExp(`[${o}]`,"g"),".*");return c=c.replace(new RegExp(`[${s}]`,"g"),"."),"\\"!==l&&(c=c.replace(new RegExp(`[${l}]`,"g"),"\\")),c=`^${c}$`,(!1===a?new RegExp(c,"i"):new RegExp(c)).test(r)}(e,t,n);default:throw new Error(`Unkown comparison operator ${e.operator}`)}}function be(e,t,n){const{type:r}=e;switch(r){case"featureid":return function(e,t){for(let n=0;n<e.length;n+=1)if(e[n]===t)return!0;return!1}(e.fids,n.getId(t));case"comparison":return we(e,t,n);case"and":if(!e.predicates)throw new Error("And filter must have predicates array.");return 0!==e.predicates.length&&e.predicates.every((e=>be(e,t,n)));case"or":if(!e.predicates)throw new Error("Or filter must have predicates array.");return e.predicates.some((e=>be(e,t,n)));case"not":if(!e.predicate)throw new Error("Not filter must have predicate.");return!be(e.predicate,t,n);default:throw new Error(`Unknown filter type: ${r}`)}}function ke(e,t){return void 0!==e.maxscaledenominator&&void 0!==e.minscaledenominator?t/28e-5<e.maxscaledenominator&&t/28e-5>e.minscaledenominator:void 0!==e.maxscaledenominator?t/28e-5<e.maxscaledenominator:void 0===e.minscaledenominator||t/28e-5>e.minscaledenominator}function xe(e,t,n){const r=[];let i=0;for(let o=0;o<e.rules.length;o+=1){const s=e.rules[o];ke(s,n.resolution)&&(s.elsefilter?(r.push(s),i+=1):s.filter?be(s.filter,t,n)&&r.push(s):r.push(s))}return i===r.length?r:r.filter((e=>!e.elsefilter))}function _e(e){return[...e.polygonsymbolizer||[],...e.linesymbolizer||[],...e.pointsymbolizer||[],...e.textsymbolizer||[]]}function Se(e,t){if(!e)return;let n=e;const r=(t||"").split(".");for(let e=0;e<r.length;e+=1){const t=r[e];if(!(t in n))return;n=n[t]}return n}const Ne=new Set;function Ce(e){Ne.has(e)||(console.warn(e),Ne.add(e))}function Pe(e){const t={polygonSymbolizers:[],lineSymbolizers:[],pointSymbolizers:[],textSymbolizers:[]};return(e||[]).forEach((e=>{e.polygonsymbolizer&&(t.polygonSymbolizers=[...t.polygonSymbolizers,...e.polygonsymbolizer]),e.linesymbolizer&&(t.lineSymbolizers=[...t.lineSymbolizers,...e.linesymbolizer]),e.pointsymbolizer&&(t.pointSymbolizers=[...t.pointSymbolizers,...e.pointsymbolizer]),e.textsymbolizer&&(t.textSymbolizers=[...t.textSymbolizers,...e.textsymbolizer])})),t}const Me=["graphic.externalgraphic","stroke.graphicstroke.graphic.externalgraphic","fill.graphicfill.graphic.externalgraphic"],Ie={};function Le(e){return Ie[e]}const ve={};function Ee(e,t){ve[e]=t}function ze(e){return ve[e]}const Oe={};function De(e,t){for(let n=0;n<Me.length;n+=1){const r=Me[n],i=Se(e,r);i&&i.onlineresource===t&&(e.__invalidated=!0,r.indexOf("graphicstroke")>-1&&(e.stroke.graphicstroke.__invalidated=!0))}}function Ae(e,t){if(e)if(Array.isArray(e))for(let n=0;n<e.length;n+=1)De(e[n],t);else De(e,t)}function Ge(e,t){e.rules&&e.rules.forEach((e=>{Ae(e.pointsymbolizer,t),Ae(e.linesymbolizer,t),Ae(e.polygonsymbolizer,t)}))}function Te(e){let t=Oe[e];return t||(t=new Promise(((t,n)=>{const r=new Image;r.onload=()=>{!function(e,t){Ie[e]=t}(e,{url:e,image:r,width:r.naturalWidth,height:r.naturalHeight}),Ee(e,N),t(e)},r.onerror=()=>{Ee(e,C),n()},r.src=e})),Ee(e,S),function(e,t){Oe[e]=t}(e,t),t)}function Re(e,t,n,r){e.forEach((e=>{_e(e).forEach((e=>{Me.forEach((i=>{const o=Se(e,i);if(!o)return;const s=o.onlineresource,l=ze(s);l&&l!==S||r[s]||(r[s]=!0,function(e,t,n){Ge(t,e),Te(e).then((()=>{Ge(t,e),"function"==typeof n&&n(e)})).catch((()=>{Ge(t,e),"function"==typeof n&&n()}))}(s,t,n))}))}))}))}const Fe=new n({}),$e=new n({image:new s({radius:8,fill:new i({color:"blue",fillOpacity:.7})})}),qe=new n({image:new s({radius:5,fill:new i({color:"#DDDDDD"}),stroke:new o({width:1,color:"#888888"})})}),We=new n({fill:new i({color:"#DDDDDD"}),stroke:new o({color:"#888888",width:1})}),He=new n({image:new l({angle:Math.PI/4,fill:new i({color:"red"}),points:4,radius:8,radius2:0,stroke:new o({color:"red",width:4})})}),Ue=new n({fill:new i({color:"red"}),stroke:new o({color:"red",width:1})});function Ve(e){const t=new WeakMap;return n=>{let r=t.get(n);return r&&!n.__invalidated||(r=e(n),n.__invalidated=!1,t.set(n,r)),r}}function Je(e,t){return null!==t&&t<1&&e.startsWith("#")?function(e,t){const n=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16);return t||0===t?`rgba(${n}, ${r}, ${i}, ${t})`:`rgb(${n}, ${r}, ${i})`}(e,t):e}const je=1,Ke=2,Xe="#000",Ye="round",Be="round";class Ze extends p{constructor(e){super({opacity:1,rotateWithView:void 0!==e.rotateWithView&&e.rotateWithView,rotation:void 0!==e.rotation?e.rotation:0,scale:void 0!==e.scale?e.scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=void 0!==e.fill?e.fill:null,this.origin_=[0,0],this.radii_=[...e.radii],this.angles_=[...e.angles],this.stroke_=void 0!==e.stroke?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?je:Ke,this.imageState_===je&&this.ready().then((()=>this.imageState_=Ke)),this.render()}clone(){const e=this.getScale(),t=new Ze({fill:this.getFill()?this.getFill().clone():void 0,radii:[...this.getRadii()],angles:[...this.getAngles()],stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),n=this.getScaleArray();return[e[0]/2-t[0]/n[0],e[1]/2+t[1]/n[1]]}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),n=`${e},${this.angle_},${this.radii_.join()},${this.angles_.join()},${t}`+Object.values(this.renderOptions_).join(",");let r=h.shared.get(n,null,null)?.getImage(1);if(!r){const t=this.renderOptions_,i=Math.ceil(t.size*e),o=m.createCanvasContext2D(i,i);this.draw_(t,o,e),r=o.canvas,h.shared.set(n,null,null,new g(r,void 0,null,Ke,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getRadii(){return this.radii_}getAngles(){return this.angles_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,n){if(0===t||"bevel"!==e&&"miter"!==e)return t;let r=0;for(let i=0;i<this.radii_.length;i+=1){let o,s=this.radii_[i],l=this.radii_[i===this.radii_.length-1?0:i+1];if(s<l){const e=s;s=l,l=e}o=i<this.radii_.length-1?this.angles_[i+1]-this.angles_[i]:2*Math.PI-this.angles_[i]+this.angles_[0];const a=l*Math.sin(o),c=s-Math.sqrt(l*l-a*a),u=Math.sqrt(a*a+c*c),f=u/a;if("miter"===e&&f<=n){r=Math.max(r,f*t);continue}const h=t/2/f,p=t/2*(c/u),m=Math.sqrt((s+h)*(s+h)+p*p)-s;if(void 0===this.radius2_||"bevel"===e){r=Math.max(r,2*m);continue}const g=s*Math.sin(o),d=l-Math.sqrt(s*s-g*g),y=Math.sqrt(g*g+d*d)/g;if(y<=n){const e=y*t/2-l-s;r=Math.max(r,2*Math.max(m,e))}else r=Math.max(r,2*m)}return r}createRenderOptions(){let e,t=Ye,n=Be,r=0,i=null,o=0,s=0;this.stroke_&&(e=f.asColorLike(this.stroke_.getColor()??"#000"),s=this.stroke_.getWidth()??1,i=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??Be,t=this.stroke_.getLineCap()??Ye,r=this.stroke_.getMiterLimit()??10);const l=this.calculateLineJoinSize_(n,s,r);let a=0;this.radii_.forEach((e=>{a=Math.max(a,e)}));return{strokeStyle:e,strokeWidth:s,size:Math.ceil(2*a+l),lineCap:t,lineDash:i,lineDashOffset:o,lineJoin:n,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,n){if(t.scale(n,n),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let e=this.fill_.getColor();null===e&&(e=Xe),t.fillStyle=f.asColorLike(e),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let n=this.fill_.getColor(),r=0;"string"==typeof n&&(n=u.asArray(n)),null===n?r=1:Array.isArray(n)&&(r=4===n.length?n[3]:1),0===r&&(t=m.createCanvasContext2D(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){for(let t=0;t<this.radii_.length;t+=1){const n=this.radii_[t],r=this.angles_[t];e.lineTo(n*Math.cos(r),-n*Math.sin(r))}e.closePath()}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Xe,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}const Qe={arrow:[[0,1],[-.5,.5],[-.25,.5],[-.25,-1],[.25,-1],[.25,.5],[.5,.5]],arrowhead:[[0,0],[-1,1],[0,0],[-1,-1]],filled_arrowhead:[[0,0],[-1,1],[-1,-1]],cross_fill:[[1,.2],[.2,.2],[.2,1],[-.2,1],[-.2,.2],[-1,.2],[-1,-.2],[-.2,-.2],[-.2,-1],[.2,-1],[.2,-.2],[1,-.2]],quarter_square:[[0,0],[0,1],[-1,1],[-1,0]],half_square:[[0,1],[-1,1],[-1,-1],[0,-1]],diagonal_half_square:[[-1,1],[-1,-1],[1,-1]],right_half_triangle:[[0,1],[-1,-1],[0,-1]],left_half_triangle:[[0,1],[0,-1],[1,-1]],"shape://carrow":[[0,0],[-1,.4],[-1,-.4]],"shape://oarrow":[[0,0],[-1,.4],[0,0],[-1,-.4]]};function et(e){const t=document.createElement("canvas");t.width=32,t.height=32;const r=t.getContext("2d"),i=a.toContext(r),o=new n({image:e});i.setStyle(o),i.drawGeometry(new c([16,16]))}function tt(e){let{wellKnownName:t,startAngle:n,endAngle:r,radius:i,stroke:o,fill:s,rotation:a}=e;const c=Math.ceil(96*(r-n)/Math.PI),u=[0],f=[0];for(let e=0;e<=c;e+=1){const t=(r-n)/c;u.push(i),f.push(n+e*t)}try{const e=new Ze({radii:u,angles:f,stroke:o,fill:s,rotation:a??0});return et(e),e}catch(e){return Ce(`Error rendering symbol '${t}'. OpenLayers v10.3.0 or higher required. ${e}`),new l({angle:Math.PI/4,fill:s,points:4,radius:i*Math.sqrt(2),stroke:o,rotation:a??0})}}function nt(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const o=t/2,a={stroke:n,fill:r,rotation:Math.PI*i/180},c=Qe[e];if(c)return function(e){let{wellKnownName:t,coordinates:n,radius:r,stroke:i,fill:o,rotation:s}=e;const a=[],c=[];n.forEach((e=>{let[t,n]=e;const i=r*Math.sqrt(t*t+n*n);let o=Math.atan2(n,t);o<2&&(o+=2*Math.PI),a.push(i),c.push(o)}));try{const e=new Ze({radii:a,angles:c,stroke:i,fill:o,rotation:s??0});return et(e),e}catch(e){return Ce(`Error rendering symbol '${t}'. OpenLayers v10.3.0 or higher required. ${e}`),new l({angle:Math.PI/4,fill:o,points:4,radius:r*Math.sqrt(2),stroke:i,rotation:s??0})}}({...a,wellKnownName:e,coordinates:c,radius:o});switch(e){case"circle":return new s({stroke:n,fill:r,radius:o});case"shape://dot":return new s({stroke:n,fill:r,radius:o/8});case"equilateral_triangle":case"triangle":return new l({...a,points:3,radius:o});case"star":return new l({...a,points:5,radius:o,radius2:o/2.5});case"shape://plus":case"cross":return new l({...a,points:4,radius:o,radius2:0});case"pentagon":return new l({...a,points:5,radius:o});case"hexagon":return new l({...a,points:6,radius:o});case"octagon":return new l({...a,angle:Math.PI/8,points:8,radius:o/Math.cos(Math.PI/8)});case"shape://times":case"cross2":case"x":return new l({...a,angle:Math.PI/4,points:4,radius:Math.sqrt(2)*o,radius2:0});case"diamond":return new l({...a,points:4,radius:o});case"shape://horline":case"horline":return new l({...a,points:2,radius:o,angle:Math.PI/2});case"shape://vertline":case"line":return new l({...a,points:2,radius:o,angle:0});case"shape://backslash":case"backslash":return new l({...a,points:2,radius:o*Math.sqrt(2),angle:-Math.PI/4});case"shape://slash":case"slash":return new l({...a,points:2,radius:o*Math.sqrt(2),angle:Math.PI/4});case"semi_circle":return tt({...a,wellKnownName:e,startAngle:0,endAngle:Math.PI,radius:o});case"third_circle":return tt({...a,wellKnownName:e,startAngle:Math.PI/2,endAngle:7*Math.PI/6,radius:o});case"quarter_circle":return tt({...a,wellKnownName:e,startAngle:Math.PI/2,endAngle:Math.PI,radius:o});default:return new l({...a,angle:Math.PI/4,points:4,radius:o*Math.sqrt(2)})}}function rt(e){if(!e)return;const t=e?.styling,n=fe(t?.stroke,null,null,"#000000"),r=fe(t?.strokeOpacity,null,null,1),i=fe(t?.strokeWidth,null,null,1),s=fe(t?.strokeDashoffset,null,null,0),l={color:Je(n,r),width:i,lineDashOffset:s},a=fe(t?.strokeLinejoin,null,null);null!==a&&(l.lineJoin=a);const c=fe(t?.strokeLinecap,null,null);null!==c&&(l.lineCap=c);const u=fe(t?.strokeDasharray,null,null);return null!==u&&(l.lineDash=u.split(" ")),new o(l)}function it(e){if(!e)return;const t=e?.styling,n=fe(t?.fill,null,null,"#808080"),r=fe(t?.fillOpacity,null,null,1);return new i({color:Je(n,r)})}function ot(e,t,n,r){const i=e.getFill();if(!i)return!1;if(!r)return!1;let o=!1;const s=(t.fill||{}).styling||{};if(ue(s.fill)||ue(s.fillOpacity)){const e=fe(s.fill,n,r,"#808080"),t=fe(s.fillOpacity,n,r,1);i.setColor(Je(e,t)),o=!0}return o}function st(e,t,n,r){const i=e.getStroke();if(!i)return!1;if(!r)return!1;let o=!1;const s=t?.stroke?.styling;if(ue(s?.strokeWidth)){const e=fe(s.strokeWidth,n,r,1);i.setWidth(e),o=!0}if(ue(s?.stroke)||ue(s?.strokeOpacity)){const e=fe(s.stroke,n,r,"#000000"),t=fe(s.strokeOpacity,n,r,1);i.setColor(Je(e,t)),o=!0}return o}const lt=it({styling:{fill:"#888888"}}),at=rt({styling:{stroke:{}}});const ct=Ve((function(e){const{graphic:t}=e;let i=fe(t.size,null,null,6);const o=fe(t.rotation,null,null,0);if(t?.externalgraphic?.onlineresource){t.size||(i=null);const e=t.externalgraphic.onlineresource;switch(ze(e)){case N:return function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const{image:o,width:s,height:l}=Le(e);return new n({image:new r({img:o,imgSize:[s,l],scale:t/l||1,rotation:Math.PI*i/180})})}(e,i,o);case S:return qe;case C:return He;default:return qe}}if(t.mark){const{wellknownname:e}=t.mark,r=it(t?.mark?.fill),s=rt(t?.mark?.stroke);return new n({image:nt(e,i,s,r,o)})}return new n({image:nt("square",i,at,lt,o)})}));function ut(e,t,n){if(!e?.graphic)return Fe;const r=ct(e);r.setGeometry(null);let i=r.getImage();const{graphic:o}=e,{size:s,rotation:l}=o,a=Number(fe(s,t,n))||6,c=Number(fe(l,t,n))||0;if(ue(l)){const e=Math.PI*c/180;i.setRotation(e)}if(o.mark){st(i,o.mark,t,n)&&i.setStroke(i.getStroke());ot(i,o.mark,t,n)&&i.setFill(i.getFill())}if(ue(s))if(o?.externalgraphic?.onlineresource){const e=a/i.getSize()[1]||1;i.setScale(e)}else"circle"===o?.mark?.wellknownname?i.setRadius(.5*a):(i=nt(o?.mark?.wellknownname??"square",a,i.getStroke(),i.getFill(),c),r.setImage(i));const{displacement:u}=o;if(u){const{displacementx:e,displacementy:r}=u;if(void 0!==e||void 0!==r){const o=fe(e,t,n)||0,s=fe(r,t,n)||0;0===o&&0===s||i.setDisplacement([o,s])}}return r}function ft(e,t){const n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function ht(e,t,n){const r=n/ft(e,t);return[e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r]}function pt(e,t,n){const r=t[0]-e[0],i=t[1]-e[1];return-Math.atan2(n?-i:i,r)}function mt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Object.assign({minimumGraphicSpacing:0},n),i=e.getCoordinates();if(0===i.length)return[];if(1===i.length)return[[...i[0],0]];if(r.placement===P){const e=i[0],t=i[1];return[[e[0],e[1],pt(e,t,r.invertY)]]}if(r.placement===M){const e=i[i.length-2],t=i[i.length-1];return[[t[0],t[1],pt(e,t,r.invertY)]]}const o=e.getLength(),s=Math.max(t,r.minimumGraphicSpacing);let l=r.initialGap||0,a=0;const c=[...i[0]],u=[...i[1]];let f=0;const h=[];for(;l<=o;){const e=ft(c,u);if(f+e<l){if(a===i.length-2)break;c[0]=u[0],c[1]=u[1],u[0]=i[a+2][0],u[1]=i[a+2][1],a+=1,f+=e}else{const e=ht(c,u,l-f),t=pt(c,u,r.invertY);r.extent&&!y.containsCoordinate(r.extent,e)||(e.push(t),h.push(e)),l+=s}}return h}function gt(e){const t=mt(e,e.getLength()/2),[n,r]=t[1];return[n,r]}let dt=!1;function yt(e,t,n,r,i,o){if(!t)return;if(Array.isArray(t[0][0]))return void t.forEach((t=>{yt(e,t,n,r,i,o)}));if(t.length<2)return;const s=r.getImage();if(!s)return;mt(new d(t),n*i,{invertY:!0,extent:e.extent_,placement:o.placement,initialGap:o.initialGap,minimumGraphicSpacing:.1}).forEach((t=>{const n=s.getRotation()+t[2];e.setImageStyle2(s,n),e.drawPoint(new c([t[0]/i,t[1]/i]))}))}function wt(e){if(!e?.stroke?.graphicstroke)throw new Error("getGraphicStrokeRenderer error: symbolizer.stroke.graphicstroke null or undefined.");const{graphicstroke:t}=e.stroke,n={placement:"PLACEMENT_DEFAULT"};return e.vendoroptions&&("firstPoint"===e.vendoroptions.placement?n.placement=P:"lastPoint"===e.vendoroptions.placement&&(n.placement=M)),(r,i)=>{const o=i.feature.getGeometry().getType();if("Point"===o||"MultiPoint"===o)return;const s=i.pixelRatio||1,l=a.toContext(i.context);!function(e){if(dt)return;const t=Object.getPrototypeOf(e);t.setImageStyle2=function(e,n){t.setImageStyle.call(this,e),this.image_&&(this.imageRotation_=n)},dt=!0}(l);let c=6;t.graphic&&t.graphic.externalgraphic&&(c=16);const u=ut(t,i.feature,null),f=Number(fe(t?.graphic?.size||c,i.feature,null,c)),h=function(e,t){const{graphicstroke:n,styling:r}=e.stroke;if("gap"in n)return n.gap+t;let i=1;if(r&&r.strokeDasharray){const e=r.strokeDasharray.split(" ");e.length>=2&&0!==e[0]&&(i=e[1]/e[0]+1)}return i*t}(e,f);n.initialGap=function(e){const{graphicstroke:t}=e.stroke;return t.initialgap||0}(e),yt(l,r,h,u,s,n)}}const bt=Ve((function(e){return e?.stroke?.graphicstroke?function(e){if(!e?.stroke?.graphicstroke)throw new Error("getGraphicStrokeStyle error: linesymbolizer.stroke.graphicstroke null or undefined.");return new n({renderer:wt(e)})}(e):new n({stroke:rt(e?.stroke)})}));function kt(e,t,n){const r=bt(e);return st(r,e,t,n),r}const xt=[[1,1]],_t=[[0,0],[2,2]],St=[[0,0],[1,1],[2,2],[3,3],[2,0],[0,2]],Nt=[[0,0],[1,1]];function Ct(e){const t=e.getContext("2d");if(1===w.DEVICE_PIXEL_RATIO)return t.createPattern(e,"repeat");const n=document.createElement("canvas");n.width=e.width*w.DEVICE_PIXEL_RATIO,n.height=e.height*w.DEVICE_PIXEL_RATIO;const r=n.getContext("2d");return r.imageSmoothingEnabled=!1,r.drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),r.createPattern(n,"repeat")}function Pt(e,t,n){const r=document.createElement("canvas");r.width=e,r.height=e;const i=r.getContext("2d");return i.fillStyle=t,function(e,t){t.forEach((t=>{let[n,r]=t;e.fillRect(n,r,1,1)}))}(i,n),Ct(r)}function Mt(e,t,n){const r=document.createElement("canvas");r.width=e,r.height=e;const i=r.getContext("2d");return i.fillStyle=t,i.fillRect(0,0,e,e),function(e,t){t.forEach((t=>{let[n,r]=t;e.clearRect(n,r,1,1)}))}(i,n),Ct(r)}function It(e){const{image:t,width:n,height:r}=Le(e.externalgraphic.onlineresource),i=document.createElement("canvas").getContext("2d");let o=w.DEVICE_PIXEL_RATIO;if(e.size&&r!==e.size&&(o*=e.size/r),1===o)return i.createPattern(t,"repeat");const s=document.createElement("canvas"),l=s.getContext("2d");return s.width=n*o,s.height=r*o,l.drawImage(t,0,0,n,r,0,0,n*o,r*o),i.createPattern(s,"repeat")}function Lt(e){const{graphicfill:t}=e.fill,{graphic:n}=t,{mark:r}=n,{wellknownname:o}=r||{};if(o&&0===o.indexOf("brush://")){let e="#000000";return r.fill&&r.fill.styling&&r.fill.styling.fill&&(e=r.fill.styling.fill),function(e,t){let n=null;switch(e){case"brush://dense1":n=new i({color:Mt(4,t,xt)});break;case"brush://dense2":n=new i({color:Mt(4,t,_t)});break;case"brush://dense3":n=new i({color:Mt(4,t,St)});break;case"brush://dense4":n=new i({color:Pt(2,t,Nt)});break;case"brush://dense5":n=new i({color:Pt(4,t,St)});break;case"brush://dense6":n=new i({color:Pt(4,t,_t)});break;case"brush://dense7":n=new i({color:Pt(4,t,xt)});break;default:n=new i({color:t})}return n}(o,e)}const s=Number(n.size)||6,l=s*w.DEVICE_PIXEL_RATIO;let u=null;try{const e=document.createElement("canvas");e.width=2*l,e.height=2*l;const n=e.getContext("2d"),r=function(e,t){if(!e.graphic)return e;const n=JSON.parse(JSON.stringify(e)),{graphic:r}=n,i=Number(r.size)||6;r.size=t*i;const{mark:o}=r;if(o&&o.stroke){o.stroke.styling||(o.stroke.styling={stroke:"#000000",strokeWidth:1}),o.stroke.styling.strokeWidth||(o.stroke.styling.strokeWidth=Number(o.stroke.styling.strokeWidth)||1);const e=o.stroke.styling.strokeWidth;e>1&&(o.stroke.styling.strokeWidth=t*e)}return n}(t,2),f=ut(r),h=a.toContext(n,{size:[2*s,2*s]});n.imageSmoothingEnabled=!1,h.setStyle(f);const p=s/2*2,m=s/2*2;h.drawGeometry(new c([p,m])),o&&o.indexOf("slash")>-1&&(h.drawGeometry(new c([p-2*s,m])),h.drawGeometry(new c([p+2*s,m])),h.drawGeometry(new c([p,m-2*s])),h.drawGeometry(new c([p,m+2*s])));const g=document.createElement("canvas");g.width=l,g.height=l;const d=g.getContext("2d");d.drawImage(e,0,0,2*l,2*l,0,0,l,l);const y=d.createPattern(g,"repeat");u=new i({color:y})}catch{u=new i({color:"#000000"})}return u}const vt=Ve((function(e){const t=e?.fill?.graphicfill?.graphic?.externalgraphic?.onlineresource,r=e?.fill?.graphicfill?.graphic?.mark;let o=null;if(o=t?function(e){const{graphic:t}=e.fill.graphicfill;switch(ze(t.externalgraphic.onlineresource)){case N:return new i({color:It(e.fill.graphicfill.graphic)});case S:return We.getFill();case C:return Ue.getFill();default:return We.getFill()}}(e):r?Lt(e):it(e.fill),e?.stroke?.graphicstroke){const t=wt(e);return new n({renderer:(e,n)=>{if(o){const{feature:t,context:r}=n,i=a.toContext(r);i.setFillStrokeStyle(o,void 0);const s=t.getGeometry().getType();"Polygon"===s?i.drawPolygon(new b(e)):"MultiPolygon"===s&&i.drawMultiPolygon(new k(e))}t(e,n)}})}const s=rt(e.stroke);return new n({fill:o,stroke:s})}));function Et(e,t,n){const r=vt(e);return ot(r,e,t,n),st(r,e,t,n),r}const zt=Ve((function(e){if(!e?.label)return Fe;const t=fe(e.label,null,null,""),r=e?.font?.styling,s=fe(r?.fontFamily,null,null,"sans-serif"),l=fe(r?.fontSize,null,null,10),a=`${fe(r?.fontStyle,null,null,"")} ${fe(r?.fontWeight,null,null,"")} ${l}px ${s}`,c=e?.labelplacement?.pointplacement,u=fe(c?.rotation,null,null,0),f=c?.displacement,h=fe(f?.displacementx,null,null,0),p=-fe(f?.displacementy,null,null,0),m=c?.anchorpoint;let g="center";const d=fe(m?.anchorpointx,null,null,NaN);d<.25?g="left":d>.75&&(g="right");let y="middle";const w=fe(m?.anchorpointy,null,null,NaN);w<.25?y="bottom":w>.75&&(y="top");const b=e?.fill?.styling,k=fe(b?.fill,null,null,"#000000"),_=fe(b?.fillOpacity,null,null,1),S={text:t,font:a,offsetX:h,offsetY:p,rotation:Math.PI*u/180,textAlign:g,textBaseline:y,fill:new i({color:Je(k,_)})};if(e.halo){const t=e?.halo?.fill?.styling,n=fe(t?.fill,null,null,"#FFFFFF"),r=fe(t?.fillOpacity,null,null,1),i=fe(e?.halo?.radius,null,null,1);S.stroke=new o({color:Je(n,r),width:2*(2===i||4===i?i-1e-5:i)})}return new n({text:new x(S)})}));function Ot(e,t,n){const r=zt(e),i=r.getText();if(!i)return r;const{label:o,labelplacement:s}=e;if(ue(o)){const e=fe(o,t,n,"");i.setText(e.toString())}if(s){const e=s?.pointplacement?.rotation??0;if(ue(e)){const r=fe(e,t,n,0);i.setRotation(Math.PI*r/180)}}const l=t.getGeometry?t.getGeometry():t.geometry,a=l.getType?l.getType():l.type,c=e?.labelplacement?.lineplacement,u="point"!==a&&c?"line":"point";i.setPlacement(u),function(e,t,n,r){const i=e.getText();if(!i)return!1;if(!r)return!1;(ue(t?.fill?.styling?.fill)||ue(t?.fill?.styling?.fillOpacity))&&st(i,{stroke:{styling:{stroke:t?.fill?.styling?.fill,strokeOpacity:t?.fill?.styling?.fillOpacity}}},n,r);if((ue(t?.halo?.fill?.styling?.fill)||ue(t?.halo?.fill?.styling?.fillOpacity))&&ot(i,t.halo,n,r),ue(t?.halo?.radius)){const e=fe(t.halo.radius,n,r,1),o=i.getStroke();if(o){const t=2*(2===e||4===e?e-1e-5:e);o.setWidth(t)}}}(r,e,t,n);const f=e?.font?.styling;if(f&&(ue(f?.fontFamily)||ue(f?.fontStyle)||ue(f?.fontWeight)||ue(f?.fontSize))){const e=fe(f?.fontFamily,t,n,"sans-serif"),r=`${fe(f?.fontStyle,t,n,"")} ${fe(f?.fontWeight,t,n,"")} ${fe(f?.fontSize,t,n,10)}px ${e}`;i.setFont(r)}return r}function Dt(e,n,r){if("function"!=typeof n.getGeometry)return null;let i=n.getGeometry();if(!i)return null;i instanceof t&&(i=t.toGeometry(i));let o=null;const s=i.getType();if("LineString"===s)o=ut(e,n,r),o.setGeometry(new c(gt(i)));else if("MultiLineString"===s){const t=i.getLineStrings().map(gt);o=ut(e,n,r),o.setGeometry(new _(t))}return o}function At(e){const[t,n]=e.getInteriorPoint().getCoordinates();return[t,n]}function Gt(e,n,r){if("function"!=typeof n.getGeometry)return null;let i=n.getGeometry();if(!i)return null;i instanceof t&&(i=t.toGeometry(i));let o=null;const s=i.getType();if("Polygon"===s)o=ut(e,n,r),o.setGeometry(new c(At(i)));else if("MultiPolygon"===s){const t=i.getPolygons().map(At);o=ut(e,n,r),o.setGeometry(new _(t))}return o}const Tt=[$e];function Rt(e,t,n,r,i){(t||[]).forEach((t=>{const o=r(t,n,i);o&&e.push(o)}))}function Ft(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{polygonSymbolizers:i,lineSymbolizers:o,pointSymbolizers:s,textSymbolizers:l}=e,a={strictGeometryMatch:!1,useFallbackStyles:!0,...r},c=t.getGeometry?t.getGeometry():t.geometry;let u=[];switch(c.getType?c.getType():c.type){case"Point":case"MultiPoint":Rt(u,s,t,ut,n),Rt(u,l,t,Ot,n);break;case"LineString":case"MultiLineString":Rt(u,o,t,kt,n),a.strictGeometryMatch||Rt(u,s,t,Dt,n),Rt(u,l,t,Ot,n);break;case"Polygon":case"MultiPolygon":Rt(u,i,t,Et,n),a.strictGeometryMatch||Rt(u,o,t,kt,n),Rt(u,s,t,Gt,n),Rt(u,l,t,Ot,n);break;default:a.useFallbackStyles&&(u=Tt)}return u.forEach(((e,t)=>e.setZIndex(t))),u}function $t(e){return e.getId()}function qt(e,t){return e.get(t)}function Wt(e){return ae(e).toLowerCase()}function Ht(e){return ae(e).toUpperCase()}function Ut(e,t,n){const r=Number(t),i=Number(n);if(Number.isNaN(r))return"";const o=ae(e);return Number.isNaN(i)?r>0?o.slice(r-1):o.slice(r):0===i?"":r>0?i>0?o.slice(r-1,r-1+i):o.slice(r-1,i):i>0?r+i<0?o.slice(r,r+i):o.slice(r):o.slice(r,i)}function Vt(e,t,n){const r=ae(e),i=Number(t),o=Number(n);return Number.isNaN(i)||Number.isNaN(o)?"":r.slice(i,o)}function Jt(e,t){const n=ae(e),r=Number(t);return Number.isNaN(r)?"":n.slice(r)}function jt(e){return e&&"function"==typeof e.getType?e.getType():"Unknown"}function Kt(e){return e?ce(e.getType()):-1}function Xt(e){switch(jt(e)){case"Point":case"MultiPoint":return"Point";case"LineString":case"LinearRing":case"Circle":case"MultiLineString":return"Line";case"Polygon":case"MultiPolygon":return"Polygon";default:return"Unknown"}}function Yt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=t,o=ae(r);return i.some((e=>ae(e)===o))}return function(){se("lower",Wt),se("upper",Ht),se("geometry_type",Xt),se("substr",Ut),se("strToLowerCase",Wt),se("strToUpperCase",Ht),se("strSubstring",Vt),se("strSubstringStart",Jt),se("geometryType",jt),se("dimension",Kt),se("in",Yt);for(let e=2;e<=10;e+=1)se(`in${e}`,Yt);se("__fe:Add__",((e,t)=>Number(e)+Number(t))),se("__fe:Sub__",((e,t)=>Number(e)-Number(t))),se("__fe:Mul__",((e,t)=>Number(e)*Number(t))),se("__fe:Div__",((e,t)=>Number(e)/Number(t)))}(),e.OlStyler=Ft,e.Reader=function(e){const t={},n=(new DOMParser).parseFromString(e,"application/xml").documentElement;return t.version=n.getAttribute("version"),ie(n,t),t},e.categorizeSymbolizers=Pe,e.createOlStyle=function(e,t){return Ft(Pe([e]),{geometry:{type:t}},(()=>null),{strictGeometryMatch:!0,useFallbackStyles:!1}).filter((e=>null!==e))},e.createOlStyleFunction=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.imageLoadedCallback||(()=>{}),r={},i={};return i.getProperty="function"==typeof t.getProperty?t.getProperty:qt,i.getId=$t,(o,s)=>{const l="function"==typeof t.convertResolution?t.convertResolution(s):s;i.resolution=l;const a=xe(e,o,i);Re(a,e,n,r);return Ft(Pe(a),o,i)}},e.getByPath=Se,e.getFunction=le,e.getLayer=function(e,t){return t?e.layers.find((e=>e.name===t)):e.layers[0]},e.getLayerNames=function(e){return e.layers.map((e=>e.name))},e.getRuleSymbolizers=_e,e.getRules=xe,e.getStyle=function(e,t){if(t)return e.styles.find((e=>e.name===t));const n=e.styles.find((e=>e.default));return n||e.styles[0]},e.getStyleNames=function(e){return e.styles.map((e=>e.name))},e.registerCustomSymbol=function(e,t){if(!t.every((e=>{let[t,n]=e;return t>=-1&&t<=1&&n>=-1&&n<=1})))throw new Error("Custom symbol coordinates must lie within [-1,-1,1,1].");const[n,r]=t[0],[i,o]=t[t.length-1];if(n===i&&r===o)throw new Error("Custom symbol start and end coordinate should not be the same. Custom symbols will close themselves.");Qe[e]=t},e.registerFunction=se,e.version="0.7.1",e.warnOnce=Ce,e}({},ol.render.Feature,ol.style.Style,ol.style.Icon,ol.style.Fill,ol.style.Stroke,ol.style.Circle,ol.style.RegularShape,ol.render,ol.geom.Point,ol.color,ol.colorlike,ol.style.IconImageCache,ol.style.Image,ol.dom,ol.style.IconImage,ol.geom.LineString,ol.extent,ol.has,ol.geom.Polygon,ol.geom.MultiPolygon,ol.style.Text,ol.geom.MultiPoint);
